steps:
- script: |
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk config --sdk-home-dir=$(SDK_DATADIR)

    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk install node
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk install electrumx
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk install electrumsv
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk install merchant_api
  displayName: 'Pre-install python-based SDK components'

- script: |
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk start --background status_monitor
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk start --background node
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk start --background electrumx
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk node generate 1
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk start --background --deterministic-seed electrumsv
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk start --background merchant_api
    sleep 5
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk status
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk node --id=node1 getinfo

    $(PYTHON_EXE) ./contrib/check_all_started.py
  displayName: 'Start all python-based components (testing)'
  continueOnError: true

- script: |
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk stop node
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk stop electrumx
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk stop electrumsv
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk stop status_monitor
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk stop merchant_api
    $(PYTHON_SCRIPTS_DIR)/electrumsv-sdk status

    $(PYTHON_EXE) ./contrib/check_all_stopped.py
  displayName: 'Stop all python-based components (testing)'
  continueOnError: true
